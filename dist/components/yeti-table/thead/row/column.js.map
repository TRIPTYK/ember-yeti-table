{"version":3,"file":"column.js","sources":["../../../../../src/components/yeti-table/thead/row/column.gjs"],"sourcesContent":["import { isArray } from '@ember/array';\nimport { assert } from '@ember/debug';\n\nimport Component from '@glimmer/component';\nimport { modifier } from 'ember-modifier';\nimport { localCopy } from 'tracked-toolbox';\n\n/**\n  An important component yielded from the header or head.row component that is used to define\n  a column of the table.\n\n  ```hbs\n  <table.header as |header|>\n    <header.column @prop=\"firstName\" as |column|>\n      First name\n      {{if column.isAscSorted \"(sorted asc)\"}}\n      {{if column.isDescSorted \"(sorted desc)\"}}\n    </header.column>\n  </table.header>\n  ```\n\n  ```hbs\n  <table.thead as |head|>\n    <head.row as |row|>\n      <row.column @prop=\"firstName\" as |column|>\n        First name\n        {{if column.isAscSorted \"(sorted asc)\"}}\n        {{if column.isDescSorted \"(sorted desc)\"}}\n      </row.column>\n    </head.row>\n  </table.thead>\n  ```\n\n  @class Column\n  @yield {object} column\n  @yield {boolean} column.isSorted - `true` if column is sorted ascending or descending\n  @yield {boolean} column.isAscSorted - `true` if column is sorted ascending\n  @yield {boolean} column.isDescSorted - `true` if column is sorted descending\n*/\nimport { on } from '@ember/modifier';\nimport { fn, hash } from '@ember/helper';\n\nexport default class Column extends Component {\n  <template>\n    {{! template-lint-disable no-invalid-interactive }}\n    {{#if this.visible}}\n      <th\n        role={{if this.sortable \"button\"}}\n        class=\"{{@class}}\n          {{@theme.theadCell}}\n          {{if this.sortable @theme.sorting.columnSortable}}\n          {{if this.isSorted @theme.sorting.columnSorted}}\n          {{if this.isAscSorted @theme.sorting.columnSortedAsc}}\n          {{if this.isDescSorted @theme.sorting.columnSortedDesc}}\"\n        {{on \"click\" (if this.sortable (fn @onClick this) this.noop)}}\n        {{this.updateName}}\n        ...attributes\n      >\n        {{yield\n          (hash\n            isSorted=this.isSorted\n            isAscSorted=this.isAscSorted\n            isDescSorted=this.isDescSorted\n          )\n        }}\n      </th>\n    {{/if}}\n  </template>\n  /**\n   * An important argument that Yeti Table uses to tie this column to a certain property on\n   * each row object of the original `@data` (or `@loadFunction`) that was passed in.\n   *\n   * This is the argument that Yeti Table uses to filter and sort the data.\n   *\n   * This argument also allows Yeti Table to keep itself up to date when the original\n   * data changes. NOTE: If this property is a nested property (one that contains periods),\n   * the table will not update when this property changes. This is due to `@each` only supporting\n   * one level of properties.\n   *\n   * If you don't need sorting, filtering or automatic table unrolling (using the blockless\n   * body component), then this property is optional.\n   *\n   * @argument prop\n   * @type {String}\n   */\n  get prop() {\n    return this.args.prop;\n  }\n\n  /**\n   * Set to `false` to hide the entire column across all rows. Keep in mind that this property\n   * won't just hide the column using css. The DOM for the column will be removed. Defaults to `true`.\n   *\n   * @argument visible\n   * @type {Boolean}\n   */\n  @localCopy('args.visible', true)\n  visible;\n\n  /**\n   * Used to turn off sorting clicking on this column (clicks won't toggle sorting anymore).\n   * Useful on avatar columns, for example, where a sorting order doesn't really make sense.\n   * Defaults to the `<YetiTable>` `@sortable` argument (which in turn defaults to `true`).\n   *\n   * @argument sortable\n   * @type Boolean\n   */\n  @localCopy('args.sortable', true)\n  sortable;\n\n  /**\n   * Optionally use an `asc` or `desc` string on this argument to turn on ascending or descending sorting\n   * on this column. Useful to turn on default sortings on the table.\n\n   * @argument sort\n   * @type {String}\n   */\n  @localCopy('args.sort')\n  sort;\n\n  /**\n   * Use `@sortSequence` to customize the sequence in which the sorting order will cycle when\n   * clicking on this column header. You can either pass in a comma-separated string or an array\n   * of strings. Accepted values are `'asc'`, `'desc'` and `'unsorted'`. The default value is `['asc', 'desc']`\n   * or whatever the global table sortSequence value is.\n   *\n   * @argument sortSequence\n   * @type Array\n   */\n\n  /**\n   * Used to turn off filtering for this column. When `false`, Yeti Table won't look for\n   * values on this column. Defaults to `true`.\n   *\n   * @argument filterable\n   * @type {Boolean}\n   */\n  @localCopy('args.filterable', true)\n  filterable;\n\n  /**\n   * The column filter. If passed in, Yeti Table will search this column for rows that contain this\n   * string and show those rows.\n   *\n   * The column definitions `@filter` argument is subtractive, meaning that it will filter out rows\n   * from the subset that passes the general `@filter`.\n   *\n   * @argument filter\n   * @type {String}\n   */\n  get filter() {\n    return this.args.filter;\n  }\n\n  /**\n   * An optional function to customize the filtering logic *on this column*. This function should return true\n   * or false to either include or exclude the row on the resulting set. If this function depends\n   * on a value, pass that value as the `@filterUsing` argument.\n   *\n   * This function will be called with two arguments:\n   * - `value` - the current data cell to use for filtering\n   * - `filterUsing` - the value you passed in as `@filterUsing`\n   *\n   * @argument filterFunction\n   * @type {Function}\n   */\n  get filterFunction() {\n    return this.args.filterFunction;\n  }\n\n  /**\n   * If you `@filterFunction` function depends on a different value (other that `@filter`)\n   * to show, pass it in this argument. Yeti Table uses this argument to know when to recalculate\n   * the fitlered rows.\n   *\n   * @argument filterUsing\n   * @type {String}\n   */\n  get filterUsing() {\n    return this.args.filterUsing;\n  }\n\n  /**\n   * Used to add a class to all the cells in this column.\n   *\n   * @argument columnClass\n   * @type {String}\n   */\n  get columnClass() {\n    return this.args.columnClass;\n  }\n\n  /**\n   * This property is a human-readable representation of the name of the column.\n   * It defaults to the trimmed `textContent` of the `<th>` element, but can be overridden\n   * by using a `@name=\"your custom name\"` argument.\n   *\n   * @argument name\n   * @type {String}\n   */\n  @localCopy('args.name')\n  name;\n\n  /**\n   * An optional function to be invoked whenever this column is clicked\n   *\n   * This function will be called with two arguments:\n   * - `column` - the column that was clicked\n   *\n   * @argument onClick\n   * @type {Function}\n   */\n\n  get isAscSorted() {\n    return this.sort === 'asc';\n  }\n\n  get isDescSorted() {\n    return this.sort === 'desc';\n  }\n\n  get isSorted() {\n    return this.isAscSorted || this.isDescSorted;\n  }\n\n  get normalizedSortSequence() {\n    let sortSequence = this.args.sortSequence;\n    assert(\n      '@sortSequence must be either a comma-separated string or an array. Got `${sortSequence}.`',\n      isArray(sortSequence) || typeof sortSequence === 'string',\n    );\n\n    if (isArray(sortSequence)) {\n      return sortSequence;\n    } else if (typeof sortSequence === 'string') {\n      return sortSequence.split(',').map((s) => s.trim());\n    } else {\n      return [];\n    }\n  }\n\n  constructor() {\n    super(...arguments);\n\n    this.args.parent?.registerColumn(this);\n  }\n\n  willDestroy() {\n    super.willDestroy(...arguments);\n    this.args.parent?.unregisterColumn(this);\n  }\n\n  updateName = modifier((element) => {\n    if (!this.args.name) {\n      this.name = element.textContent.trim();\n    }\n  });\n\n  noop = () => {};\n}\n"],"names":["Column","Component","setComponentTemplate","precompileTemplate","strictMode","scope","on","fn","hash","prop","args","g","prototype","localCopy","i","filter","filterFunction","filterUsing","columnClass","isAscSorted","sort","isDescSorted","isSorted","normalizedSortSequence","sortSequence","assert","isArray","split","map","s","trim","constructor","arguments","parent","registerColumn","willDestroy","unregisterColumn","updateName","modifier","element","name","textContent","noop"],"mappings":"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"}